<html>

<head>
  <link rel="stylesheet" href="./style.css" />
  <script type="text/javascript" src="./render.js"></script>
  <script type="text/javascript" src="./editor.js"></script>
  <script type="text/javascript" src="./manager.js"></script>
  <script type="text/javascript" src="./library.js"></script>
  <script type="text/javascript" src="./index.js"></script>
</head>

<body>
  <div class="main" onmouseup="endResize()" onmousemove="resizeCodePanel(event)">
    <div id="canvas-container"></div>
    <div id="code-container">
      <div id="code-toggle" onclick="toggleCode()">&#9654;</div>
      <div class="resizer" onmousedown="startResize(event)"></div>
      <div style="margin-bottom: 5px;">
        <div id="file-toggle" onclick="toggleFiles()">&raquo;</div>
        <button onclick="saveRun()" style="font-weight: bold; font-size: 12pt;">SAVE/RUN</button>
        <button onclick="exportGame()">EXPORT</button>
        <button onclick="importGame()">IMPORT</button>
        <button onclick="newGame()">CLEAR ALL</button>
        <button onclick="loadImage()">LOAD IMAGE</button>
        <button onclick="showLibrary(true)">LIBRARY</button>
        <button onclick="showDocs(true)">HELP</button>
      </div>
      <div class="editor-area">
        <div id="files-block">
          <div class="files-menu">
            <button onclick="addFile()">Ôºã</button>
            <button onclick="deleteFile()">Ôºç</button>
            <button onclick="addExternal()">	üîó</button>
          </div>
          <div id="files-list"></div>
        </div>
        <div id="code-block">
          <div class="tabs"></div>
          <textarea onkeydown="editorKeydown(event)" onkeyup="event.stopPropagation()" id="code-editor"></textarea>
        </div>
      </div>
      <div id="library-panel">
        <div class="close" onclick="showLibrary(false)">&times;</div>
        Library
        <button onclick="showUploadGame()">UPLOAD...</button>
        <ul id="library-list" onclick="loadGame(event.target)">
        </ul>
      </div>
      <div id="docs-panel">
        <div class="close" onclick="showDocs(false)">&times;</div>
        HTML Game Builder <i>v2.1.1</i>
        <ul>
          <li>
            <span>function setup(game)</span>
            <i>called when your game launches</i>
          </li>
          <li>
            <span>function update(game, frame, keys)</span>
            <i>called every 30ms to run your game</i>
          </li>
          <li>
            <span>function draw(game, images, frame, context, canvas)</span>
            <i>called when your game needs to render, resets the canvas</i>
          </li>
          <li>
            <span>function handleClick(game, event)</span>
            <i>called whenever the canvas is clicked</i>
          </li>
          <li>
            <span>addImage(url)</span>
            <i>Load an image from a url, returns the image object</i>
          </li>
          <li>
            <span>addAudio(url)</span>
            <i>Load a sound from a url, returns the audio object</i>
          </li>
          <li>
            Adding Files:
            <i>Additional code files must all define classes and return the class definition</i>
          </li>
        </ul>
      </div>
    </div>
    <div id="image-loader">
      <h3>Load Image</h3>
      <div>
        Image Name
        <input id="image-name" />
      </div>
      <div id="local-section">
        Image Filepath
        <input id="image-filepath" type="file" onchange="readImageFile(event)" />
      </div>
      <div>
        <button onclick="doLoadImage()">OK</button>
        <button onclick="cancelLoadImage()">CANCEL</button>
      </div>
    </div>
    <div id="library-loader">
      <h3>Upload Game</h3>
      <div>
        Name
        <input id="game-name" />
      </div>
      <div>
        Description
        <textarea id="game-description"></textarea>
      </div>
      <div>
        <button onclick="uploadGame()">UPLOAD</button>
        <button onclick="cancelUploadGame()">CANCEL</button>
      </div>
    </div>
  </div>
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-app.js"></script>

  <!-- TODO: Add SDKs for Firebase products that you want to use
       https://firebase.google.com/docs/web/setup#available-libraries -->
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-firestore.js"></script>

  <script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
      apiKey: "AIzaSyB2AONH0KskXRGqccS_8BmpYUTaI2L9vvk",
      authDomain: "olive-hero-game-builder-21.firebaseapp.com",
      projectId: "olive-hero-game-builder-21",
      storageBucket: "olive-hero-game-builder-21.appspot.com",
      messagingSenderId: "54990119298",
      appId: "1:54990119298:web:843f5bf4faac2e65362f9b"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    // https://firebase.google.com/docs/firestore/quickstart
    const [, resizeCanvas] = makeCanvas(document.getElementById('canvas-container'), {
      width: 1600,
      height: 900
    });
    setupCanvasClickHandler();
    restoreImages();
    initializeTabs();
    initializeFiles();
    initializeDb();
    loadExternals();
    toggleCode(true);
    toggleFiles(JSON.parse(window.localStorage.getItem('show-files')));
    saveRun();
  </script>
</body>

</html>